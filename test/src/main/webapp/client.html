<html>
<head>
<title>client</title>
<meta charset="utf-8" />
<script type="text/javascript">
	// general variables
	var ws;
	var array = [];
	var currentTime = 0;
	// general functions
	function play(){
		var blob = new Blob(array,{mimeType:"audio/ogg"});
		var url = URL.createObjectURL(blob);
		
		var audio = document.querySelector("audio");
		currentTime = audio.currentTime;
		audio.src = url;
	}
	
	function loadedData(audio){
		while(audio.isPlaying){}
		audio.currentTime = currentTime;
	}
	//start method
	function start() {
		// preparing ws
		ws = new WebSocket('ws://localhost:8080/test/main');
		// handle events
		ws.addEventListener("open", function() {
			console.log("open")
		});

		ws.onmessage = function(msg){
			var blob = msg.data;
			array.push(blob);
			play();
		}

		ws.addEventListener("close", function() {
			console.log("closed");
		});
	}
</script>
</head>
<body onload="start()">
	<h1>client</h1>
	<audio autoplay="autoplay" onloadeddata="loadedData(this)"></audio>
</body>
</html>